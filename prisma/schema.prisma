generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Table {
  id          Int           @id @default(autoincrement())
  name        String        @db.VarChar(50)
  capacity    Int
  x           Float         @default(0)
  y           Float         @default(0)
  zone        String?
  shape       String?       @default("rectangle") // "rectangle" or "circle"
  width       Float?
  height      Float?
  description String?
  created_at  DateTime      @default(now()) @db.Timestamptz(6)
  
  reservations Reservation[]

  @@map("tables")
}

model Reservation {
  id               String    @id @default(uuid())
  booking_code     String?   @unique
  guest_name       String
  guest_phone      String
  guest_email      String?
  party_size       Int
  reservation_date String    // Format: YYYY-MM-DD
  reservation_time String    // Format: HH:mm
  status           String    @default("pending") // pending, confirmed, cancelled
  special_requests String?
  payment_slip_url String?
  
  table_number     Int?
  table            Table?    @relation(fields: [table_number], references: [id])
  
  feedback         Feedback?
  
  created_at       DateTime  @default(now()) @db.Timestamptz(6)

  @@map("reservations")
}

model Feedback {
  id             Int          @id @default(autoincrement())
  reservation_id String       @unique
  reservation    Reservation  @relation(fields: [reservation_id], references: [id])
  
  rating         Int          @default(5)
  comment        String?
  
  created_at     DateTime     @default(now()) @db.Timestamptz(6)

  @@map("feedback")
}
